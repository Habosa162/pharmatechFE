<div class="doctor-sidebar-layout">
  <nav class="sidebar-list">
    <ul>
      <li [class.active]="activeTab === 'appointments'" (click)="setActiveTab('appointments')">
        <span class="icon">ðŸ“…</span> Appointments
      </li>
      <li [class.active]="activeTab === 'patients'" (click)="setActiveTab('patients')">
        <span class="icon">ðŸ‘¤</span> Patients
      </li>
      <li [class.active]="activeTab === 'surgeries'" (click)="setActiveTab('surgeries')">
        <span class="icon">ðŸ©º</span> Surgeries
      </li>
      <li [class.active]="activeTab === 'labtests'" (click)="setActiveTab('labtests')">
        <span class="icon">ðŸ§ª</span> Labtests
      </li>
    </ul>
  </nav>
  <div class="main-content">
    <ng-container [ngSwitch]="activeTab">
      <div *ngSwitchCase="'appointments'">
        <h3>Appointments</h3>
        <div *ngIf="appointments.length; else noAppointments">
          <div *ngFor="let appointment of appointments" class="card">
            <div class="appointment-header">
              <div class="appointment-info">
                <div><b>ID:</b> {{ appointment.id }}</div>
                <div><b>Name:</b> {{ appointment.name }}</div>
                <div><b>Date:</b> {{ appointment.appointmentDate }}</div>
                <div><b>Status:</b> {{ appointment.status }}</div>
                <div><b>Notes:</b> {{ appointment.notes }}</div>
              </div>
              <div class="appointment-actions">
                <button 
                  class="btn btn-primary btn-sm" 
                  (click)="openExaminationModal(appointment)"
                  data-bs-toggle="modal" 
                  data-bs-target="#examinationModal">
                  <i class="fas fa-stethoscope"></i> Start Examination
                </button>
              </div>
            </div>
          </div>
        </div>
        <ng-template #noAppointments>
          <div class="empty-state">No appointments found.</div>
        </ng-template>
      </div>
      <div *ngSwitchCase="'patients'">
        <h3>Patients</h3>
        <div *ngIf="patients.length; else noPatients">
          <div *ngFor="let patient of patients" class="card">
            <div><b>ID:</b> {{ patient.id }}</div>
            <div><b>Name:</b> {{ patient.name }}</div>
            <div><b>Email:</b> {{ patient.email }}</div>
          </div>
        </div>
        <ng-template #noPatients>
          <div class="empty-state">No patients found.</div>
        </ng-template>
      </div>
      <div *ngSwitchCase="'surgeries'">
        <h3>Surgeries</h3>
        <div *ngIf="surgeries.length; else noSurgeries">
          <div *ngFor="let surgery of surgeries" class="card">
            <div><b>ID:</b> {{ surgery.id }}</div>
            <div><b>Name:</b> {{ surgery.doctorName }}</div>
            <div><b>Date:</b> {{ surgery.surgeryDate }}</div>
            <div><b>Patient:</b> {{ surgery.patientName }}</div>
          </div>
        </div>
        <ng-template #noSurgeries>
          <div class="empty-state">No surgeries found.</div>
        </ng-template>
      </div>
      <div *ngSwitchCase="'labtests'">
        <h3>Labtests</h3>
        <div *ngIf="labtests.length; else noLabtests">
          <div *ngFor="let labtest of labtests" class="card">
            <div><b>ID:</b> {{ labtest.id }}</div>
            <div><b>Name:</b> {{ labtest.name }}</div>
            <div><b>Reference:</b> {{ labtest.reference }}</div>
          </div>
        </div>
        <ng-template #noLabtests>
          <div class="empty-state">No labtests found.</div>
        </ng-template>
      </div>
    </ng-container>
  </div>
</div>

<!-- Examination Modal -->
<div class="modal fade" id="examinationModal" tabindex="-1" aria-labelledby="examinationModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="examinationModalLabel">
          <i class="fas fa-stethoscope text-primary"></i>
          Start Examination - {{ selectedAppointment?.name }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="medicalRecordForm" (ngSubmit)="createMedicalRecord()">
          <div class="mb-3">
            <label class="form-label">Visit Date</label>
            <input 
              class="form-control" 
              type="datetime-local" 
              formControlName="visitDate"
              required>
          </div>
          <div class="mb-3">
            <label class="form-label">Notes</label>
            <textarea 
              class="form-control" 
              rows="4" 
              formControlName="notes"
              placeholder="Enter examination notes..."></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Appointment ID</label>
            <input 
              class="form-control" 
              type="number" 
              formControlName="appointmentId"
              readonly>
          </div>
        </form>
        <div *ngIf="error" class="alert alert-danger">
          <i class="fas fa-exclamation-triangle"></i> {{ error }}
        </div>
        <div *ngIf="loading" class="text-center">
          <div class="spinner-border text-primary" role="status"></div>
          <span class="ms-2">Creating medical record...</span>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          <i class="fas fa-times"></i> Cancel
        </button>
        <button 
          type="button" 
          class="btn btn-primary" 
          (click)="createMedicalRecord()"
          [disabled]="medicalRecordForm.invalid || loading">
          <i class="fas fa-save"></i> Create Medical Record
        </button>
      </div>
    </div>
  </div>
</div> 