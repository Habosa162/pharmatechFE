<div class="app-container">
  <!-- Header -->
  <header class="page-header" *ngIf="patient">
    <div class="header-content">
      <div class="header-left">
        <button class="btn-back" (click)="goBack()">
          <i class="fas fa-arrow-left"></i>
        </button>
        <div class="header-title">
          <h1>Patient Prescriptions</h1>
          <div class="patient-info">
            <span class="patient-name">{{patient.name}}</span>
            <span class="patient-id">#{{patient.id}}</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Stats Cards -->
  <!-- <section class="stats-section">
    <div class="stats-grid">
      <div class="stat-card total">
        <div class="stat-content">
          <span class="stat-value">{{getTotalPrescriptions()}}</span>
          <span class="stat-label">Total Prescriptions</span>
        </div>
        <div class="stat-icon">
          <i class="fas fa-file-medical"></i>
        </div>
      </div>
      
      <div class="stat-card active">
        <div class="stat-content">
          <span class="stat-value">{{getActivePrescriptions()}}</span>
          <span class="stat-label">Active Medications</span>
        </div>
        <div class="stat-icon">
          <i class="fas fa-pills"></i>
        </div>
      </div>

      <div class="stat-card recent">
        <div class="stat-content">
          <span class="stat-value">{{getLastPrescriptionDate() | date:'mediumDate'}}</span>
          <span class="stat-label">Last Prescription</span>
        </div>
        <div class="stat-icon">
          <i class="fas fa-calendar-check"></i>
        </div>
      </div>
    </div>
  </section> -->

  <!-- Filters -->
  <section class="filters-section">
    <div class="filter-container">
      <div class="filter-header">
        <h2>Filter Prescriptions</h2>
        <button class="btn-clear" [disabled]="!hasActiveFilters()" (click)="clearFilters()">
          Clear Filters
        </button>
      </div>
      <div class="filter-body">
        <div class="filter-group">
          <label>Year</label>
          <select [(ngModel)]="selectedYear" (change)="onYearFilterChange()">
            <option value="all">All Years</option>
            <option *ngFor="let year of availableYears" [value]="year">{{year}}</option>
          </select>
        </div>
      </div>
    </div>
  </section>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <span>Loading prescriptions...</span>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="error">
    <div class="error-icon">
      <i class="fas fa-exclamation-circle"></i>
    </div>
    <p>{{error}}</p>
    <button class="btn-retry" (click)="loadPrescriptions(patient?.id!)">Retry</button>
  </div>

  <!-- Prescriptions Grid -->
  <section class="prescriptions-section" *ngIf="!loading && !error">
    <div class="prescriptions-grid" *ngIf="filteredPrescriptions.length > 0">
      <div class="prescription-card" *ngFor="let prescription of getPaginatedPrescriptions()">
        <div class="prescription-header">
          <div class="prescription-date">
            <i class="fas fa-calendar"></i>
            {{prescription.prescriptionDate | date:'mediumDate'}}
          </div>
          <div class="prescription-id">#{{prescription.id}}</div>
        </div>
        <div class="prescription-body">
          <h3>Prescription Details</h3>
          <div class="prescription-info">
            <div class="info-item">
              <i class="fas fa-user-md"></i>
              <span>Dr. {{prescription.doctorName}}</span>
            </div>
            <div class="info-item">
              <i class="fas fa-pills"></i>
              <span>{{prescription.medications.length}} Medications</span>
            </div>
            <div class="info-item diagnosis">
              <i class="fas fa-stethoscope"></i>
              <span>{{prescription.diagnosis}}</span>
            </div>
          </div>
        </div>
        <div class="prescription-footer">
          <button class="btn-view" (click)="viewPrescription(prescription.id)">
            View Details
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && !error && filteredPrescriptions.length === 0">
      <div class="empty-icon">
        <i class="fas fa-clipboard-check"></i>
      </div>
      <h3>No Prescriptions Found</h3>
      <p>There are no prescriptions matching your current filters.</p>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button class="btn-page" [disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button 
        *ngFor="let page of getPageNumbers()" 
        class="btn-page" 
        [class.active]="page === currentPage"
        (click)="goToPage(page)">
        {{page}}
      </button>
      <button class="btn-page" [disabled]="currentPage === totalPages" (click)="goToPage(currentPage + 1)">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </section>
</div>