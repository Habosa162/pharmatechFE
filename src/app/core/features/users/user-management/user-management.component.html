<div class="user-management-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <h1 class="page-title">
        <i class="fas fa-users"></i>
        User Management
      </h1>
      <p class="page-subtitle">Manage system users, roles, and permissions</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-outline-info me-2" (click)="testToasts()">
        <i class="fas fa-bell"></i>
        Test Toasts
      </button>
      <button class="btn btn-outline-warning me-2" (click)="testPhoneValidation()">
        <i class="fas fa-phone"></i>
        Test Phone Validation
      </button>
      <button class="btn btn-primary" (click)="showCreateUserModal()">
        <i class="fas fa-plus"></i>
        Create New User
      </button>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filters-content">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input
          type="text"
          placeholder="Search users..."
          [(ngModel)]="searchTerm"
          (input)="onFilterChange()"
          class="form-control"
        >
      </div>

      <div class="filter-controls">
        <select
          [(ngModel)]="selectedRole"
          (change)="onFilterChange()"
          class="form-select"
        >
          <option value="all">All Roles</option>
          <option *ngFor="let role of availableRoles" [value]="role">{{ role }}</option>
        </select>

        <select
          [(ngModel)]="selectedStatus"
          (change)="onFilterChange()"
          class="form-select"
        >
          <option value="all">All Status</option>
          <option value="active">Active</option>
          <option value="inactive">Inactive</option>
        </select>

        <button class="btn btn-outline-secondary" (click)="clearFilters()">
          <i class="fas fa-times"></i>
          Clear Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Users List Section -->
  <div class="users-section">
    <div class="section-header">
      <h3>Users ({{ filteredUsers.length }})</h3>
      <div class="loading-spinner" *ngIf="loading">
        <i class="fas fa-spinner fa-spin"></i>
        Loading users...
      </div>
    </div>

    <div class="users-grid" *ngIf="!loading">
      <div class="user-card" *ngFor="let user of filteredUsers">
        <div class="user-card-header">
          <div class="user-avatar">
            <img
              [src]="getProfilePictureUrl(user)"
              [alt]="user.fullName"
              class="avatar-image"
              (error)="onImageError($event)"
            >
            <div class="status-indicator" [class.active]="user.isActive"></div>
          </div>
          <div class="user-info">
            <h4 class="user-name">{{ user.fullName }}</h4>
            <p class="user-username">#{{ user.userName }}</p>
            <p class="user-email">{{ user.email }}</p>
          </div>
          <div class="user-actions">
            <button class="btn btn-sm btn-outline-primary" (click)="showUserDetailsModal(user)">
              <i class="fas fa-eye"></i>
            </button>
            <button class="btn btn-sm btn-outline-secondary" (click)="showEditUserModal(user)">
              <i class="fas fa-edit"></i>
            </button>
            <button class="btn btn-sm btn-outline-danger" (click)="showDeleteUserModal(user)">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>

        <div class="user-card-body">
          <div class="user-details">
            <div class="detail-item">
              <span class="detail-label">Phone:</span>
              <span class="detail-value">{{ user.phoneNumber || 'Not provided' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Created:</span>
              <span class="detail-value">{{ formatDate(user.createdAt) }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Last Login:</span>
              <span class="detail-value">{{ user.lastLoginDate ? formatDateTime(user.lastLoginDate) : 'Never' }}</span>
            </div>
          </div>

          <div class="user-roles">
            <span class="detail-label">Roles:</span>
            <div class="roles-container">
              <span
                *ngFor="let role of user.roles"
                class="badge"
                [class]="getRoleBadgeClass(role)"
              >
                {{ role }}
                <button
                  class="role-remove-btn"
                  (click)="removeRole(user, role)"
                  title="Remove role"
                >
                  <i class="fas fa-times"></i>
                </button>
              </span>
              <button
                class="btn btn-sm btn-outline-primary add-role-btn"
                (click)="openAssignRoleModal(user)"
              >
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>

          <div class="user-status">
            <span
              class="badge"
              [class]="getStatusBadgeClass(user.isActive)"
            >
              {{ getStatusText(user.isActive) }}
            </span>
            <button
              class="btn btn-sm"
              [class]="user.isActive ? 'btn-warning' : 'btn-success'"
              (click)="toggleUserStatus(user)"
              [disabled]="saving"
            >
              <i class="fas" [class]="user.isActive ? 'fa-ban' : 'fa-check'"></i>
              {{ user.isActive ? 'Deactivate' : 'Activate' }}
            </button>
          </div>
        </div>

        <div class="user-card-footer">
          <button
            class="btn btn-sm btn-outline-info"
            (click)="openChangePasswordModal(user)"
          >
            <i class="fas fa-key"></i>
            Change Password
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && filteredUsers.length === 0">
      <i class="fas fa-users"></i>
      <h3>No users found</h3>
      <p>No users match your current filters. Try adjusting your search criteria.</p>
      <button class="btn btn-primary" (click)="clearFilters()">
        Clear Filters
      </button>
    </div>
  </div>
</div>

<!-- Create User Modal -->
<div class="modal-overlay" *ngIf="showCreateModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Create New User</h3>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <form [formGroup]="userForm" (ngSubmit)="createUser()" class="modal-body">
      <div class="form-row">
        <div class="form-group">
          <label for="userName">Username *</label>
          <input
            type="text"
            id="userName"
            formControlName="userName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'userName')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'userName')">
            {{ getFieldError(userForm, 'userName') }}
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email *</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'email')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'email')">
            {{ getFieldError(userForm, 'email') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="firstName">First Name *</label>
          <input
            type="text"
            id="firstName"
            formControlName="firstName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'firstName')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'firstName')">
            {{ getFieldError(userForm, 'firstName') }}
          </div>
        </div>

        <div class="form-group">
          <label for="lastName">Last Name *</label>
          <input
            type="text"
            id="lastName"
            formControlName="lastName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'lastName')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'lastName')">
            {{ getFieldError(userForm, 'lastName') }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="dateOfBirth">Date of Birth *</label>
        <input
          type="date"
          id="dateOfBirth"
          formControlName="dateOfBirth"
          class="form-control"
          [class.is-invalid]="isFieldInvalid(userForm, 'dateOfBirth')"
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'dateOfBirth')">
          {{ getFieldError(userForm, 'dateOfBirth') }}
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="password">Password *</label>
          <input
            type="password"
            id="password"
            formControlName="password"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'password')"
          >
          <div class="form-text">
            Password must be at least 8 characters and contain: uppercase letter, lowercase letter, number, and special character
          </div>
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'password')">
            {{ getFieldError(userForm, 'password') }}
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password *</label>
          <input
            type="password"
            id="confirmPassword"
            formControlName="confirmPassword"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'confirmPassword')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'confirmPassword')">
            {{ getFieldError(userForm, 'confirmPassword') }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="phoneNumber">Phone Number *</label>
        <input
          type="text"
          id="phoneNumber"
          formControlName="phoneNumber"
          class="form-control"
          maxlength="11"
          placeholder="12345678901"
          (input)="onPhoneNumberInput($event)"
          [class.is-invalid]="isFieldInvalid(userForm, 'phoneNumber')"
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'phoneNumber')">
          {{ getFieldError(userForm, 'phoneNumber') }}
        </div>
      </div>

      <div class="form-group">
        <label for="roles">Roles *</label>
        <div class="roles-checkboxes">
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="role-Master"
              formControlName="roleMaster"
              class="form-check-input"
            >
            <label for="role-Master" class="form-check-label">
              Master
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="role-Owner"
              formControlName="roleOwner"
              class="form-check-input"
            >
            <label for="role-Owner" class="form-check-label">
              Owner
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="role-Admin"
              formControlName="roleAdmin"
              class="form-check-input"
            >
            <label for="role-Admin" class="form-check-label">
              Admin
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="role-User"
              formControlName="roleUser"
              class="form-check-input"
            >
            <label for="role-User" class="form-check-label">
              User
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="role-Accountant"
              formControlName="roleAccountant"
              class="form-check-input"
            >
            <label for="role-Accountant" class="form-check-label">
              Accountant
            </label>
          </div>
        </div>
        <div class="invalid-feedback" *ngIf="!hasSelectedRoles()">
          At least one role must be selected
        </div>
      </div>

      <div class="form-group">
        <label for="profilePicture">Profile Picture</label>
        <input
          type="file"
          id="profilePicture"
          (change)="onFileSelected($event)"
          accept="image/*"
          class="form-control"
        >
        <div class="image-preview" *ngIf="previewUrl">
          <img [src]="previewUrl" alt="Preview" class="preview-image" (error)="onImageError($event)">
          <button type="button" class="btn btn-sm btn-danger" (click)="removeProfilePicture()">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
    </form>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
      <button
        class="btn btn-primary"
        (click)="createUser()"
        [disabled]="userForm.invalid || saving"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
        {{ saving ? 'Creating...' : 'Create User' }}
      </button>
    </div>
  </div>
</div>

<!-- Edit User Modal -->
<div class="modal-overlay" *ngIf="showEditModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Edit User</h3>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <form [formGroup]="userForm" (ngSubmit)="updateUser()" class="modal-body">
      <div class="form-row">
        <div class="form-group">
          <label for="editUserName">Username *</label>
          <input
            type="text"
            id="editUserName"
            formControlName="userName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'userName')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'userName')">
            {{ getFieldError(userForm, 'userName') }}
          </div>
        </div>

        <div class="form-group">
          <label for="editEmail">Email *</label>
          <input
            type="email"
            id="editEmail"
            formControlName="email"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'email')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'email')">
            {{ getFieldError(userForm, 'email') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="editFirstName">First Name *</label>
          <input
            type="text"
            id="editFirstName"
            formControlName="firstName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'firstName')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'firstName')">
            {{ getFieldError(userForm, 'firstName') }}
          </div>
        </div>

        <div class="form-group">
          <label for="editLastName">Last Name *</label>
          <input
            type="text"
            id="editLastName"
            formControlName="lastName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid(userForm, 'lastName')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'lastName')">
            {{ getFieldError(userForm, 'lastName') }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="editDateOfBirth">Date of Birth *</label>
        <input
          type="date"
          id="editDateOfBirth"
          formControlName="dateOfBirth"
          class="form-control"
          [class.is-invalid]="isFieldInvalid(userForm, 'dateOfBirth')"
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'dateOfBirth')">
          {{ getFieldError(userForm, 'dateOfBirth') }}
        </div>
      </div>

      <div class="form-group">
        <label for="editPhoneNumber">Phone Number *</label>
        <input
          type="text"
          id="editPhoneNumber"
          formControlName="phoneNumber"
          class="form-control"
          maxlength="11"
          placeholder="12345678901"
          (input)="onPhoneNumberInput($event)"
          [class.is-invalid]="isFieldInvalid(userForm, 'phoneNumber')"
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid(userForm, 'phoneNumber')">
          {{ getFieldError(userForm, 'phoneNumber') }}
        </div>
      </div>

      <div class="form-group">
        <label for="editRoles">Roles *</label>
        <div class="roles-checkboxes">
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="editRole-Master"
              formControlName="roleMaster"
              class="form-check-input"
            >
            <label for="editRole-Master" class="form-check-label">
              Master
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="editRole-Owner"
              formControlName="roleOwner"
              class="form-check-input"
            >
            <label for="editRole-Owner" class="form-check-label">
              Owner
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="editRole-Admin"
              formControlName="roleAdmin"
              class="form-check-input"
            >
            <label for="editRole-Admin" class="form-check-label">
              Admin
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="editRole-User"
              formControlName="roleUser"
              class="form-check-input"
            >
            <label for="editRole-User" class="form-check-label">
              User
            </label>
          </div>
          <div class="role-checkbox">
            <input
              type="checkbox"
              id="editRole-Accountant"
              formControlName="roleAccountant"
              class="form-check-input"
            >
            <label for="editRole-Accountant" class="form-check-label">
              Accountant
            </label>
          </div>
        </div>
        <div class="invalid-feedback" *ngIf="!hasSelectedRoles()">
          At least one role must be selected
        </div>
      </div>

      <div class="form-group">
        <label for="editProfilePicture">Profile Picture</label>
        <input
          type="file"
          id="editProfilePicture"
          (change)="onFileSelected($event)"
          accept="image/*"
          class="form-control"
        >
        <div class="image-preview" *ngIf="previewUrl">
          <img [src]="previewUrl" alt="Preview" class="preview-image" (error)="onImageError($event)">
          <button type="button" class="btn btn-sm btn-danger" (click)="removeProfilePicture()">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
    </form>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
      <button
        class="btn btn-primary"
        (click)="updateUser()"
        [disabled]="userForm.invalid || saving"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
        {{ saving ? 'Updating...' : 'Update User' }}
      </button>
    </div>
  </div>
</div>

<!-- Delete User Modal -->
<div class="modal-overlay" *ngIf="showDeleteModal" (click)="closeModal()">
  <div class="modal-content modal-sm" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Delete User</h3>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="delete-confirmation">
        <i class="fas fa-exclamation-triangle text-warning"></i>
        <p>Are you sure you want to delete the user <strong>{{ selectedUser?.fullName }}</strong>?</p>
        <p class="text-muted">This action cannot be undone.</p>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
      <button
        class="btn btn-danger"
        (click)="deleteUser()"
        [disabled]="deleting"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="deleting"></i>
        {{ deleting ? 'Deleting...' : 'Delete User' }}
      </button>
    </div>
  </div>
</div>

<!-- User Details Modal -->
<div class="modal-overlay" *ngIf="showDetailsModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>User Details</h3>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="modal-body" *ngIf="selectedUser">
      <div class="user-details-view">
        <div class="user-profile">
          <img
            [src]="getProfilePictureUrl(selectedUser)"
            [alt]="selectedUser.fullName"
            class="profile-image"
            (error)="onImageError($event)"
          >
          <div class="profile-info">
            <h4>{{ selectedUser.fullName }}</h4>
            <p class="username">{{ getFormattedUsername(selectedUser.userName) }}</p>
            <span
              class="badge"
              [class]="getStatusBadgeClass(selectedUser.isActive)"
            >
              {{ getStatusText(selectedUser.isActive) }}
            </span>
          </div>
        </div>

        <div class="details-grid">
          <div class="detail-item">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{ selectedUser.email }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Phone:</span>
            <span class="detail-value">{{ selectedUser.phoneNumber || 'Not provided' }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Date of Birth:</span>
            <span class="detail-value">{{ selectedUser.dateOfBirth ? formatDate(selectedUser.dateOfBirth) : 'Not provided' }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Created:</span>
            <span class="detail-value">{{ formatDateTime(selectedUser.createdAt) }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Last Login:</span>
            <span class="detail-value">{{ selectedUser.lastLoginDate ? formatDateTime(selectedUser.lastLoginDate) : 'Never' }}</span>
          </div>
        </div>

        <div class="roles-section">
          <h5>Roles</h5>
          <div class="roles-list">
            <span
              *ngFor="let role of selectedUser.roles"
              class="badge"
              [class]="getRoleBadgeClass(role)"
            >
              {{ role }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Close</button>
    </div>
  </div>
</div>

<!-- Change Password Modal -->
<div class="modal-overlay" *ngIf="showChangePasswordModal" (click)="closeModal()">
  <div class="modal-content modal-sm" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Change Password</h3>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <form [formGroup]="changePasswordForm" (ngSubmit)="changePassword()" class="modal-body">
      <div class="form-group">
        <label for="currentPassword">Current Password *</label>
        <input
          type="password"
          id="currentPassword"
          formControlName="currentPassword"
          class="form-control"
          [class.is-invalid]="isFieldInvalid(changePasswordForm, 'currentPassword')"
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid(changePasswordForm, 'currentPassword')">
          {{ getFieldError(changePasswordForm, 'currentPassword') }}
        </div>
      </div>

      <div class="form-group">
        <label for="newPassword">New Password *</label>
        <input
          type="password"
          id="newPassword"
          formControlName="newPassword"
          class="form-control"
          [class.is-invalid]="isFieldInvalid(changePasswordForm, 'newPassword')"
        >
        <div class="form-text">
          Password must be at least 8 characters and contain: uppercase letter, lowercase letter, number, and special character
        </div>
        <div class="invalid-feedback" *ngIf="isFieldInvalid(changePasswordForm, 'newPassword')">
          {{ getFieldError(changePasswordForm, 'newPassword') }}
        </div>
      </div>

      <div class="form-group">
        <label for="confirmNewPassword">Confirm New Password *</label>
        <input
          type="password"
          id="confirmNewPassword"
          formControlName="confirmNewPassword"
          class="form-control"
          [class.is-invalid]="isFieldInvalid(changePasswordForm, 'confirmNewPassword')"
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid(changePasswordForm, 'confirmNewPassword')">
          {{ getFieldError(changePasswordForm, 'confirmNewPassword') }}
        </div>
      </div>
    </form>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
      <button
        class="btn btn-primary"
        (click)="changePassword()"
        [disabled]="changePasswordForm.invalid || changingPassword"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="changingPassword"></i>
        {{ changingPassword ? 'Changing...' : 'Change Password' }}
      </button>
    </div>
  </div>
</div>

<!-- Assign Role Modal -->
<div class="modal-overlay" *ngIf="showAssignRoleModal" (click)="closeModal()">
  <div class="modal-content modal-sm" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Assign Role</h3>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <form [formGroup]="assignRoleForm" (ngSubmit)="assignRole()" class="modal-body">
      <div class="form-group">
        <label for="role">Select Role *</label>
        <select
          id="role"
          formControlName="role"
          class="form-select"
          [class.is-invalid]="isFieldInvalid(assignRoleForm, 'role')"
        >
          <option value="">Choose a role...</option>
          <option *ngFor="let role of availableRoles" [value]="role">{{ role }}</option>
        </select>
        <div class="invalid-feedback" *ngIf="isFieldInvalid(assignRoleForm, 'role')">
          {{ getFieldError(assignRoleForm, 'role') }}
        </div>
      </div>
    </form>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
      <button
        class="btn btn-primary"
        (click)="assignRole()"
        [disabled]="assignRoleForm.invalid || saving"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
        {{ saving ? 'Assigning...' : 'Assign Role' }}
      </button>
    </div>
  </div>
</div>
